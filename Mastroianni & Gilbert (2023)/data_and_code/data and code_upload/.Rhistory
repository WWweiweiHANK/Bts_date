table(dat$inclusion)
dat <- dat[is.na(dat$inclusion),]
#####report initial demographics####
dim(dat)
table(dat$gender)
summary(dat$age)
round(prop.table(table(dat$race)),2)
####exclusions####
##attention check
dat$inclusion[dat$check != "Other"] <- "exclude"
dat$reason[dat$check != "Other"] <- "check"
dat$inclusion[dat$check_4_TEXT == ""] <- "exclude"
table(dat$check_4_TEXT)
table(dat$inclusion)
dat <- dat[is.na(dat$inclusion),]
##age check
table(dat$inclusion)
dat$inclusion[dat$age_1 == "18-24" & (dat$age < 18 | dat$age > 24)] <- "exclude"
dat$inclusion[dat$age_1 == "25-29" & (dat$age < 25 | dat$age > 29)] <- "exclude"
dat$inclusion[dat$age_1 == "30-34" & (dat$age < 30 | dat$age > 34)] <- "exclude"
dat$inclusion[dat$age_1 == "35-39" & (dat$age < 35 | dat$age > 39)] <- "exclude"
dat$inclusion[dat$age_1 == "40-44" & (dat$age < 40 | dat$age > 44)] <- "exclude"
dat$inclusion[dat$age_1 == "45-49" & (dat$age < 45 | dat$age > 49)] <- "exclude"
dat$inclusion[dat$age_1 == "50-54" & (dat$age < 50 | dat$age > 54)] <- "exclude"
dat$inclusion[dat$age_1 == "55-59" & (dat$age < 55 | dat$age > 59)] <- "exclude"
dat$inclusion[dat$age_1 == "60-64" & (dat$age < 60 | dat$age > 64)] <- "exclude"
dat$inclusion[dat$age_1 == "65-69" & (dat$age < 65 | dat$age > 69)] <- "exclude"
dat$age[!is.na(dat$inclusion)]
dat$age_1[!is.na(dat$inclusion)]
##yeah generally these don't look great
table(dat$inclusion)
dat <- dat[is.na(dat$inclusion),]
##manipulation check
summary(dat$today)
dat$born <- coalesce(dat$X2000_born, dat$X1995_born, dat$X1990_born,
dat$X1985_born, dat$X1980_born, dat$X1975_born,
dat$X1970_born, dat$X1965_born,
dat$X1960_born, dat$X1955_.born)
summary(dat$born)
dat$twenty <- coalesce(dat$X2015, dat$X2010, dat$X2005, dat$X2000, dat$X1995, dat$X1990,
dat$X1985, dat$X1980, dat$X1975)
summary(dat$twenty)
dat$before20 <- coalesce(dat$X1980_before,
dat$X1975_before,
dat$X1970_before,
dat$X1965_before,
dat$X1960_before,
dat$X1955_before,
dat$X1950_before,
dat$X1945_before,
dat$X1940_before,
dat$X1935_before)
summary(dat$before20)
dat$before40 <- coalesce(dat$X1960_before2,
dat$X1955_before2,
dat$X1950_before2,
dat$X1945_before2,
dat$X1940_before2,
dat$X1935_before2,
dat$X1930_before2,
dat$X1925_before2,
dat$X1920_before2,
dat$X1915_before2)
summary(dat$before40)
##adding effects
dat$diff <- dat$today - dat$born
dat$diff_born <- dat$today - dat$born
dat$diff_20 <- dat$today - dat$twenty
dat$diff_before20 <- dat$today - dat$before20
dat$diff_before40 <- dat$today - dat$before40
##consistency check
dat$diff_cat <- NULL
dat$diff_cat[dat$diff_before40 == 0] <- "equal"
dat$diff_cat[dat$diff_before40 > 0] <- "more"
dat$diff_cat[dat$diff_before40 < 0] <- "less"
names(dat)
dat$cat <- paste(dat$check_60, dat$check_65, dat$check_70, dat$check_75,
dat$check_80, dat$check_85, dat$check_90, dat$check_95, dat$check_100,
dat$check_105, sep = "")
dat$cat <- as.factor(dat$cat)
levels(dat$cat)
dat$cat2 <- mapvalues(dat$cat, from = c("People are equally kind, honest, nice, and good today compared to about 100 years ago",
"People are equally kind, honest, nice, and good today compared to about 105 years ago",
"People are equally kind, honest, nice, and good today compared to about 60 years ago",
"People are equally kind, honest, nice, and good today compared to about 65 years ago",
"People are equally kind, honest, nice, and good today compared to about 70 years ago",
"People are equally kind, honest, nice, and good today compared to about 75 years ago",
"People are equally kind, honest, nice, and good today compared to about 80 years ago",
"People are equally kind, honest, nice, and good today compared to about 85 years ago",
"People are equally kind, honest, nice, and good today compared to about 90 years ago",
"People are equally kind, honest, nice, and good today compared to about 95 years ago",
"People are LESS kind, honest, nice, and good today compared to about 100 years ago",
"People are LESS kind, honest, nice, and good today compared to about 105 years ago",
"People are LESS kind, honest, nice, and good today compared to about 60 years ago",
"People are LESS kind, honest, nice, and good today compared to about 65 years ago",
"People are LESS kind, honest, nice, and good today compared to about 70 years ago",
"People are LESS kind, honest, nice, and good today compared to about 75 years ago",
"People are LESS kind, honest, nice, and good today compared to about 80 years ago",
"People are LESS kind, honest, nice, and good today compared to about 85 years ago",
"People are LESS kind, honest, nice, and good today compared to about 90 years ago",
"People are LESS kind, honest, nice, and good today compared to about 95 years ago",
"People are MORE kind, honest, nice, and good today compared to about 100 years ago",
"People are MORE kind, honest, nice, and good today compared to about 105 years ago",
"People are MORE kind, honest, nice, and good today compared to about 60 years ago",
"People are MORE kind, honest, nice, and good today compared to about 65 years ago",
"People are MORE kind, honest, nice, and good today compared to about 70 years ago",
"People are MORE kind, honest, nice, and good today compared to about 75 years ago",
"People are MORE kind, honest, nice, and good today compared to about 80 years ago",
"People are MORE kind, honest, nice, and good today compared to about 85 years ago",
"People are MORE kind, honest, nice, and good today compared to about 90 years ago",
"People are MORE kind, honest, nice, and good today compared to about 95 years ago"),
to = c("equal","equal","equal","equal","equal","equal","equal","equal","equal","equal",
"less","less","less","less","less","less","less","less","less","less",
"more","more","more","more","more","more","more","more","more","more"))
table(dat$cat2, dat$diff_cat)
dat$inclusion[dat$cat2 != dat$diff_cat] <- "exclude"
table(dat$inclusion)
dim(dat)
##creating differences
dat$born_minus_twenty <- dat$born - dat$twenty
dat$twenty_minus_today <- dat$twenty - dat$today
dat$born_minus_today <- dat$born - dat$today
#####re-report demographics after exclusions#####
dat <- dat[is.na(dat$inclusion),]
dim(dat)
table(dat$gender)
summary(dat$age)
round(prop.table(table(dat$race)),2)
good_melt <- reshape(dat, varying = c("today","twenty","born", "before20","before40"),
v.names = "rating", timevar = "time",
times = c("today","twenty","born", "before20","before40"),
direction = "long",
idvar = "participant")
good_melt$time <- as.factor(good_melt$time)
levels(good_melt$time)
good_melt$time <- factor(good_melt$time,levels(good_melt$time)[c(2, 1, 3, 5, 4)])
#####model#####
good_melt$time <- as.factor(good_melt$time)
levels(good_melt$time)
good_mod <- lmer(rating ~ time + (1|participant), data = good_melt)
summary(good_mod)
means <- emmeans(good_mod, specs = ~ time)
means
eff_size(means, sigma = sigma(good_mod), edf = 914)
plot(good_mod, type = c("p", "smooth"), col.line = "black")
hist(good_melt$rating)
plot(good_mod)
qqline(resid(good_mod))
plot(good_mod, type = c("p", "smooth"), col.line = "black")
hist(good_melt$rating)
plot(good_mod)
qqline(resid(good_mod))
##R code for analyses in Study 5a of "The Illusion of Moral Decline" (Mastroianni & Gilbert, 2023)
#####IMPORTANT NOTES#####
##DO NOT open this code file by dragging it into a pre-existing R session.
##Instead, open the .rproj file
##This project is meant to be self-contained, and packages will install and load as necessary.
##However, it will not work unless opened via the .rproj file.
##Session info is available at the end of this document.
##if you encounter any issues, please email Adam Mastroianni at adam.m.mastroianni@gmail.com
#####SETUP#####
##Set seed to make any analyses involving random sampling reproducible
addTaskCallback(function(...) {set.seed(123);TRUE})
##Note that this will make the bootstraps return the same numbers each time you run them
##if you set the seed normally with set.seed(), running the line again will naturally return a different result
require(ggplot2)
require(dplyr)
require(plyr)
require(lme4)
require(lmerTest)
require(tidyr)
require(psych)
require(jtools)
require(lsr)
require(emmeans)
dat <- read.csv("study5a.csv")
head(dat)
dim(dat)
#####data cleaning, remove incompletes#####
dat$inclusion <- NULL
dat$reason <- NULL
dat$inclusion[dat$Finished == "FALSE"] <- "exclude"
dat$reason[dat$Finished == "FALSE"] <- "incomplete"
table(dat$inclusion)
dat <- dat[is.na(dat$inclusion),]
##english test
dat$inclusion[dat$footwear != "Bell bottoms"] <- "exclude"
dat$inclusion[dat$rsvp != "A wedding invitation"] <- "exclude"
dat$inclusion[dat$elevator != "An elevator"] <- "exclude"
dat$reason[dat$inclusion == "exclude"] <- "english"
table(dat$inclusion)
dat <- dat[is.na(dat$inclusion),]
dim(dat)
#####report initial demographics#####
table(dat$gender)
summary(dat$age)
round(prop.table(table(dat$race)), 2)
#####exclusions#####
##attention 1
dat$inclusion[!is.na(dat$final_check)] <- "exclude"
table(dat$inclusion)
dat <- dat[is.na(dat$inclusion),]
##attention check
dat$inclusion[dat$check_3 != "Other"] <- "exclude"
dat$reason[dat$check_3 != "Other"] <- "check"
table(dat$inclusion)
dat$inclusion[dat$check_3_4_TEXT == "both"] <- "exclude"
dat$inclusion[dat$check_3_4_TEXT == "Both, depends on situation"] <- "exclude"
dat$inclusion[dat$check_3_4_TEXT == "shor"] <- "exclude"
dat$inclusion[dat$check_3_4_TEXT == "shoes"] <- "exclude"
dat <- dat[is.na(dat$inclusion),]
dim(dat)
##year check
dat$birth_year <- as.numeric(as.character(dat$birth_year))
dat$year_age <- 2020 - dat$birth_year
dat$age_check <- NULL
for(i in 1:nrow(dat)){
if((dat$year_age[i] - dat$age[i]) > 1 | (dat$year_age[i] - dat$age[i]) < 0){
dat$age_check[i] <- "fail"
} else{dat$age_check[i] <- "pass"}
}
dat$year_age - dat$age
table(dat$age_check)
dat$inclusion[dat$age_check == "fail"] <- "exclude"
dat$reason[dat$age_check == "fail"] <- "age_check"
dat <- dat[dat$age_check == "pass",]
dim(dat)
#####re-report demographics after exclusions#####
table(dat$gender)
summary(dat$age)
round(prop.table(table(dat$race)),2)
#####model#####
##moral decline
t.test(dat$overall)
cohensD(dat$overall)
t.test(dat$all_change)
cohensD(dat$all_change)
t.test(dat$all_replacement)
cohensD(dat$all_replacement)
t.test(dat$known_change)
cohensD(dat$known_change)
t.test(dat$known_replacement)
cohensD(dat$known_replacement)
t.test(dat$all_replacement, dat$known_replacement, paired = T)
cohensD(dat$all_replacement, dat$known_replacement)
#####covariates#####
##dichotomize having kids
dat$kids_cat <- mapvalues(dat$kids, from = c("0","1","2","3","4+"),
to = c("no_kids","kids","kids","kids","kids"))
dat$kids_cat <- relevel(as.factor(dat$kids_cat), ref = "no_kids")
dat$political_ideology_n <- mapvalues(dat$political_ideology, from = c("Very liberal","Somewhat liberal","Neither liberal nor conservative",
"Somewhat conservative","Very conservative"),
to = c(-2,-1,0,1,2))
dat$political_ideology_n <- as.numeric(as.character(dat$political_ideology_n))
dat$education_n <- mapvalues(dat$education, from = c("High school diploma","Some college","Associate's degree",
"Four-year college degree","Some graduate school","Graduate school"),
to = c(1,2,3,4,5,6))
dat$education_n <- as.numeric(as.character(dat$education_n))
big_mod <- lm(overall ~ political_ideology_n + age + race + gender + education_n + kids_cat, data = dat)
summary(big_mod)
confint(big_mod)
means <- emmeans(big_mod, specs = ~ race)
means
contr <- contrast(means, method = "pairwise", adjust = "holm")
contr
confint(contr)
plot(good_mod, type = c("p", "smooth"), col.line = "black")
##R code for analyses in Study 5a of "The Illusion of Moral Decline" (Mastroianni & Gilbert, 2023)
#####IMPORTANT NOTES#####
##DO NOT open this code file by dragging it into a pre-existing R session.
##Instead, open the .rproj file
##This project is meant to be self-contained, and packages will install and load as necessary.
##However, it will not work unless opened via the .rproj file.
##Session info is available at the end of this document.
##if you encounter any issues, please email Adam Mastroianni at adam.m.mastroianni@gmail.com
#####SETUP#####
##Set seed to make any analyses involving random sampling reproducible
addTaskCallback(function(...) {set.seed(123);TRUE})
##Note that this will make the bootstraps return the same numbers each time you run them
##if you set the seed normally with set.seed(), running the line again will naturally return a different result
require(ggplot2)
require(dplyr)
require(plyr)
require(lme4)
require(lmerTest)
require(tidyr)
require(psych)
require(jtools)
require(lsr)
require(emmeans)
dat <- read.csv("study5a.csv")
head(dat)
dim(dat)
#####data cleaning, remove incompletes#####
dat$inclusion <- NULL
dat$reason <- NULL
dat$inclusion[dat$Finished == "FALSE"] <- "exclude"
dat$reason[dat$Finished == "FALSE"] <- "incomplete"
table(dat$inclusion)
dat <- dat[is.na(dat$inclusion),]
##english test
dat$inclusion[dat$footwear != "Bell bottoms"] <- "exclude"
dat$inclusion[dat$rsvp != "A wedding invitation"] <- "exclude"
dat$inclusion[dat$elevator != "An elevator"] <- "exclude"
dat$reason[dat$inclusion == "exclude"] <- "english"
table(dat$inclusion)
dat <- dat[is.na(dat$inclusion),]
dim(dat)
#####report initial demographics#####
table(dat$gender)
summary(dat$age)
round(prop.table(table(dat$race)), 2)
#####exclusions#####
##attention 1
dat$inclusion[!is.na(dat$final_check)] <- "exclude"
table(dat$inclusion)
dat <- dat[is.na(dat$inclusion),]
##attention check
dat$inclusion[dat$check_3 != "Other"] <- "exclude"
dat$reason[dat$check_3 != "Other"] <- "check"
table(dat$inclusion)
dat$inclusion[dat$check_3_4_TEXT == "both"] <- "exclude"
dat$inclusion[dat$check_3_4_TEXT == "Both, depends on situation"] <- "exclude"
dat$inclusion[dat$check_3_4_TEXT == "shor"] <- "exclude"
dat$inclusion[dat$check_3_4_TEXT == "shoes"] <- "exclude"
dat <- dat[is.na(dat$inclusion),]
dim(dat)
##year check
dat$birth_year <- as.numeric(as.character(dat$birth_year))
dat$year_age <- 2020 - dat$birth_year
dat$age_check <- NULL
for(i in 1:nrow(dat)){
if((dat$year_age[i] - dat$age[i]) > 1 | (dat$year_age[i] - dat$age[i]) < 0){
dat$age_check[i] <- "fail"
} else{dat$age_check[i] <- "pass"}
}
dat$year_age - dat$age
table(dat$age_check)
dat$inclusion[dat$age_check == "fail"] <- "exclude"
dat$reason[dat$age_check == "fail"] <- "age_check"
dat <- dat[dat$age_check == "pass",]
dim(dat)
#####re-report demographics after exclusions#####
table(dat$gender)
summary(dat$age)
round(prop.table(table(dat$race)),2)
#####model#####
##moral decline
t.test(dat$overall)
cohensD(dat$overall)
t.test(dat$all_change)
cohensD(dat$all_change)
t.test(dat$all_replacement)
cohensD(dat$all_replacement)
t.test(dat$known_change)
cohensD(dat$known_change)
t.test(dat$known_replacement)
cohensD(dat$known_replacement)
t.test(dat$all_replacement, dat$known_replacement, paired = T)
cohensD(dat$all_replacement, dat$known_replacement)
#####covariates#####
##dichotomize having kids
dat$kids_cat <- mapvalues(dat$kids, from = c("0","1","2","3","4+"),
to = c("no_kids","kids","kids","kids","kids"))
dat$kids_cat <- relevel(as.factor(dat$kids_cat), ref = "no_kids")
dat$political_ideology_n <- mapvalues(dat$political_ideology, from = c("Very liberal","Somewhat liberal","Neither liberal nor conservative",
"Somewhat conservative","Very conservative"),
to = c(-2,-1,0,1,2))
dat$political_ideology_n <- as.numeric(as.character(dat$political_ideology_n))
dat$education_n <- mapvalues(dat$education, from = c("High school diploma","Some college","Associate's degree",
"Four-year college degree","Some graduate school","Graduate school"),
to = c(1,2,3,4,5,6))
dat$education_n <- as.numeric(as.character(dat$education_n))
big_mod <- lm(overall ~ political_ideology_n + age + race + gender + education_n + kids_cat, data = dat)
summary(big_mod)
confint(big_mod)
means <- emmeans(big_mod, specs = ~ race)
means
contr <- contrast(means, method = "pairwise", adjust = "holm")
contr
confint(contr)
##predicting overall moral decline
mod1 <- lm(overall ~ all_change + all_replacement, data = dat[dat$known_in_check == "No",])
summary(mod1)
mod2 <- lm(overall ~ all_change + all_replacement + known_change, data = dat[dat$known_in_check != "No",])
summary(mod2)
mod3 <- lm(overall ~ all_change + all_replacement + known_change + known_replacement, data = dat[(dat$replacements_yes != "No" | dat$replacements_yes.1 != "No") & dat$known_in_check != "No",])
summary(mod3)
##Set seed to make any analyses involving random sampling reproducible
addTaskCallback(function(...) {set.seed(123);TRUE})
##Note that this will make the bootstraps return the same numbers each time you run them
##if you set the seed normally with set.seed(), running the line again will naturally return a different result
options(scipen = 999) ##prevent scientific notation
require(jtools)
require(ggplot2)
require(dplyr)
require(plyr)
require(lme4)
require(lmerTest)
require(psych)
require(emmeans)
require(blme)
require(lsr)
##read in data
dat <- read.csv("study2a.csv")
dim(dat)
head(dat)
#####clean data, remove any incompletes#####
dat$inclusion <- NULL
dat$reason <- NULL
dat$inclusion[dat$Finished == "FALSE"] <- "exclude"
dat$reason[dat$Finished == "FALSE"] <- "incomplete"
table(dat$inclusion)
dat <- dat[is.na(dat$inclusion),]
#####participant demographics#####
dim(dat)
table(dat$gender)
summary(dat$age)
round(prop.table(table(dat$race)),2)
#####exclusions#####
dat$inclusion[dat$check != "Other"] <- "exclude"
dat$reason[dat$check != "Other"] <- "check"
table(dat$inclusion)
levels(as.factor(dat$check_4_TEXT))
dat$inclusion[dat$check_4_TEXT == ""] <- "exclude"
table(dat$inclusion)
dat$inclusion[dat$check_4_TEXT == "Ambivert "] <- "exclude"
table(dat$inclusion)
dat <- dat[is.na(dat$inclusion),]
dim(dat)
##consistency check
table(dat$manip_check)
dat$trend <- dat$today - dat$X2000
summary(dat$trend)
describeBy(dat$trend, dat$manip_check)
dat$trend_cat <- NULL
dat$trend_cat[dat$trend == 0] <- "equal"
dat$trend_cat[dat$trend > 0] <- "more"
dat$trend_cat[dat$trend < 0] <- "less"
dat$manip_check <- as.factor(dat$manip_check)
levels(dat$manip_check)
dat$strict <- NULL
dat$strict[dat$trend < 0 & dat$manip_check !=  "I said that people today are LESS kind, honest, nice, and good today than people were 20 years ago"] <- "exclude"
dat$strict[dat$trend == 0 & dat$manip_check != "I said that people today are EQUALLY kind, honest, nice, and good today as people were 20 years ago"] <- "exclude"
dat$strict[dat$trend > 0 & dat$manip_check != "I said that people today are MORE kind, honest, nice, and good today than people were 20 years ago"] <- "exclude"
table(dat$strict)
#####exclude quality check exclusions, re-report demos#####
dat <- dat[is.na(dat$strict),]
dim(dat)
table(dat$gender)
summary(dat$age)
round(prop.table(table(dat$race)),2)
##reshape data
good_melt <- reshape(dat, varying = c("today","X2010","X2000"),
v.names = "rating", timevar = "year", times = c("2020","2010","2000"),
direction = "long", idvar = "participant")
good_melt <- good_melt[is.na(good_melt$strict),]
#####main analysis#####
good_mod <- lmer(rating ~ year + (1|participant), data = good_melt)
summary(good_mod)
means <- emmeans(good_mod, specs = ~ year)
means
eff_size(means, edf = 1394, sigma = sigma(good_mod))
contr <- contrast(means, method = "pairwise", adjust = "holm")
contr
confint(contr)
####check model###
plot(good_mod, type = c("p", "smooth"), col.line = "black")
hist(good_melt$rating)
plot(good_mod)
qqline(resid(good_mod))
#####covariates####
dat$diff <- dat$today - dat$X2000
##dichotomize having kids
dat$kids_cat <- mapvalues(dat$kids, from = c("0","1","2","3","4+"),
to = c("no_kids","kids","kids","kids","kids"))
dat$kids_cat <- relevel(as.factor(dat$kids_cat), ref = "no_kids")
##make ideology continuous
dat$political_ideology_n <- mapvalues(dat$political_ideology, from = c("Very liberal","Somewhat liberal","Neither liberal nor conservative",
"Somewhat conservative","Very conservative"),
to = c(-2,-1,0,1,2))
dat$political_ideology_n <- as.numeric(as.character(dat$political_ideology_n))
##make education continuous
dat$education_n <- mapvalues(dat$education, from = c("High school diploma","Some college","Associate's degree",
"Four-year college degree","Some graduate school","Graduate school"),
to = c(1,2,3,4,5,6))
dat$education_n <- as.numeric(as.character(dat$education_n))
#fit model
big_mod <- lm(diff ~ political_ideology_n + age + race + gender + education_n + kids_cat, data = dat)
summary(big_mod)
confint(big_mod)
means <- emmeans(big_mod, specs = ~ race)
means
contr <- contrast(means, method = "pairwise", adjust = "holm")
contr
confint(contr)
##perception across political spectrum
t.test(dat$diff[dat$political_ideology == "Very liberal" | dat$political_ideology == "Somewhat liberal"])
cohensD(dat$diff[dat$political_ideology == "Very liberal" | dat$political_ideology == "Somewhat liberal"])
####plot####
col_grid <- rgb(235, 235, 235, 100, maxColorValue = 500)
plot <- ggplot(good_melt, aes(x = year, y = rating)) +
stat_summary(fun.data = "mean_cl_boot", size = 1.5) +
stat_summary(fun.data = "mean_cl_boot", size = 1.5, geom = "errorbar") +
coord_cartesian(ylim = c(4,5.5)) +
xlab("Year") +
ylab("Perceived Morality") +
theme_apa() +
scale_x_discrete(expand = c(.0, .0)) +
theme(panel.grid.major.y = element_line(color = "gray",
size = 0.5),
panel.grid.minor.y = element_line(color = col_grid))
